<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>历史记录</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .status-bar {
            height: 44px;
            background: linear-gradient(180deg, #f8f9fa 0%, #ffffff 100%);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
        }
        .tab-bar {
            height: 83px;
            background: rgba(248, 248, 248, 0.94);
            backdrop-filter: blur(20px);
            border-top: 0.5px solid rgba(0,0,0,0.1);
        }
        .chart-bar {
            transition: all 0.3s ease;
        }
        .chart-bar:hover {
            opacity: 0.8;
        }
        .time-filter-tab {
            transition: all 0.2s ease;
            border-radius: 12px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
        }
        .time-filter-tab.active {
            background: #3b82f6;
            color: white;
        }
        .time-filter-tab:not(.active) {
            background: #f3f4f6;
            color: #6b7280;
        }
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
        }
        .pie-chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
    </style>
</head>
<body class="bg-gray-50 h-screen overflow-hidden">
    <!-- 状态栏 -->
    <div class="status-bar">
        <div>9:41</div>
        <div class="flex items-center space-x-1">
            <i class="fas fa-signal text-xs"></i>
            <i class="fas fa-wifi text-xs"></i>
            <i class="fas fa-battery-three-quarters text-xs"></i>
        </div>
    </div>

    <!-- 主内容区 -->
    <div class="flex flex-col" style="height: calc(100vh - 127px); max-height: 717px; overflow-y: auto;">
        <!-- 导航栏 -->
        <div class="bg-white px-6 py-3 shadow-sm">
            <h1 class="text-xl font-bold text-gray-900">统计</h1>
            <p class="text-gray-600 text-sm">已练习 7 天，共完成 28 组练习</p>
        </div>

        <!-- 时间筛选标签 -->
        <div class="bg-white px-6 py-3 border-b border-gray-100">
            <div class="flex space-x-2 overflow-x-auto">
                <button class="time-filter-tab active" onclick="switchTimeFilter('all', this)">全部</button>
                <button class="time-filter-tab" onclick="switchTimeFilter('week', this)">本周</button>
                <button class="time-filter-tab" onclick="switchTimeFilter('month', this)">本月</button>
                <button class="time-filter-tab" onclick="switchTimeFilter('year', this)">本年</button>
            </div>
        </div>

        <!-- 统计卡片 -->
        <div class="bg-white px-6 py-4 border-b border-gray-100">
            <div class="grid grid-cols-3 gap-4">
                <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600" id="total-questions">80</div>
                    <div class="text-gray-500 text-xs">总题数</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-green-600" id="accuracy-rate">87.5%</div>
                    <div class="text-gray-500 text-xs">总正确率</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-orange-600" id="avg-time">7.3秒</div>
                    <div class="text-gray-500 text-xs">平均用时</div>
                </div>
            </div>
        </div>

        <!-- 题型分布饼状图 -->
        <div class="bg-white px-6 py-4 border-b border-gray-100">
            <h3 class="font-semibold text-gray-900 mb-4">题型分布</h3>
            <div class="pie-chart-container">
                <canvas id="typeDistributionChart"></canvas>
            </div>
            <!-- 图例 -->
            <div class="grid grid-cols-2 gap-2 mt-4 text-xs">
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-cyan-500 rounded mr-2"></div>
                    <span class="text-gray-600">两位数加减</span>
                </div>
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-orange-400 rounded mr-2"></div>
                    <span class="text-gray-600">三位数加减</span>
                </div>
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-red-600 rounded mr-2"></div>
                    <span class="text-gray-600">两位数乘一位数</span>
                </div>
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-gray-400 rounded mr-2"></div>
                    <span class="text-gray-600">多位数除两位数</span>
                </div>
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-slate-600 rounded mr-2"></div>
                    <span class="text-gray-600">多位数除三位数</span>
                </div>
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-red-500 rounded mr-2"></div>
                    <span class="text-gray-600">四位数除法选择题</span>
                </div>
            </div>
        </div>

        <!-- 正确率趋势折线图 -->
        <div class="bg-white px-6 py-4 border-b border-gray-100">
            <h3 class="font-semibold text-gray-900 mb-4">正确率趋势</h3>
            <div class="chart-container">
                <canvas id="accuracyTrendChart"></canvas>
            </div>
        </div>

        <!-- 用时趋势折线图 -->
        <div class="bg-white px-6 py-4 border-b border-gray-100">
            <h3 class="font-semibold text-gray-900 mb-4">用时趋势</h3>
            <div class="chart-container">
                <canvas id="timeTrendChart"></canvas>
            </div>
        </div>

        <!-- 练习热力图 -->
        <div class="bg-white px-6 py-4 border-b border-gray-100">
            <h3 class="font-semibold text-gray-900 mb-3">最近练习情况</h3>
            <div class="grid grid-cols-7 gap-1">
                <!-- 一周的练习数据 -->
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-200 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500">一</div>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-400 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500">二</div>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-600 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500">三</div>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-300 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500">四</div>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-500 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500">五</div>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-gray-200 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500">六</div>
                </div>
                <div class="text-center">
                    <div class="w-8 h-8 bg-green-600 rounded mx-auto mb-1"></div>
                    <div class="text-xs text-gray-500 font-semibold">今</div>
                </div>
            </div>
            <div class="flex items-center justify-between mt-3 text-xs text-gray-500">
                <span>较少</span>
                <div class="flex space-x-1">
                    <div class="w-3 h-3 bg-gray-200 rounded-sm"></div>
                    <div class="w-3 h-3 bg-green-200 rounded-sm"></div>
                    <div class="w-3 h-3 bg-green-400 rounded-sm"></div>
                    <div class="w-3 h-3 bg-green-600 rounded-sm"></div>
                </div>
                <span>较多</span>
            </div>
        </div>

        <!-- 题型分析图表 -->
        <div class="bg-white px-6 py-4 border-b border-gray-100">
            <h3 class="font-semibold text-gray-900 mb-3">题型正确率分析</h3>
            <div class="space-y-3">
                <div class="flex items-center">
                    <div class="w-16 text-sm text-gray-600">加法</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-2 mx-3">
                        <div class="chart-bar bg-blue-500 h-2 rounded-full" style="width: 88%"></div>
                    </div>
                    <div class="w-12 text-sm font-medium text-blue-600">88%</div>
                </div>
                <div class="flex items-center">
                    <div class="w-16 text-sm text-gray-600">减法</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-2 mx-3">
                        <div class="chart-bar bg-green-500 h-2 rounded-full" style="width: 92%"></div>
                    </div>
                    <div class="w-12 text-sm font-medium text-green-600">92%</div>
                </div>
                <div class="flex items-center">
                    <div class="w-16 text-sm text-gray-600">乘法</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-2 mx-3">
                        <div class="chart-bar bg-purple-500 h-2 rounded-full" style="width: 76%"></div>
                    </div>
                    <div class="w-12 text-sm font-medium text-purple-600">76%</div>
                </div>
                <div class="flex items-center">
                    <div class="w-16 text-sm text-gray-600">除法</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-2 mx-3">
                        <div class="chart-bar bg-orange-500 h-2 rounded-full" style="width: 81%"></div>
                    </div>
                    <div class="w-12 text-sm font-medium text-orange-600">81%</div>
                </div>
            </div>
        </div>

        <!-- 历史记录列表 -->
        <div class="px-6 py-4">
            <h3 class="font-semibold text-gray-900 mb-3">最近练习</h3>
            
            <!-- 今天 -->
            <div class="mb-4">
                <div class="text-sm font-medium text-gray-500 mb-2">今天</div>
                <div class="space-y-2">
                    <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-plus text-blue-600 text-sm"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-gray-900">两位数加法</div>
                                    <div class="text-xs text-gray-500">20题 · 正确率 85%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-medium text-gray-900">4:32</div>
                                <div class="text-xs text-gray-500">14:30</div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-times text-purple-600 text-sm"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-gray-900">乘法练习</div>
                                    <div class="text-xs text-gray-500">20题 · 正确率 95%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-medium text-gray-900">3:45</div>
                                <div class="text-xs text-gray-500">10:15</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 昨天 -->
            <div class="mb-4">
                <div class="text-sm font-medium text-gray-500 mb-2">昨天</div>
                <div class="space-y-2">
                    <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-plus text-green-600 text-sm"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-gray-900">三位数加法</div>
                                    <div class="text-xs text-gray-500">20题 · 正确率 90%</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-medium text-gray-900">5:12</div>
                                <div class="text-xs text-gray-500">19:20</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 底部标签栏 -->
    <div class="tab-bar flex items-center justify-around pt-2">
        <div class="flex flex-col items-center space-y-1">
            <i class="fas fa-home text-gray-400 text-lg"></i>
            <span class="text-gray-400 text-xs">首页</span>
        </div>
        <div class="flex flex-col items-center space-y-1">
            <i class="fas fa-exclamation-triangle text-gray-400 text-lg"></i>
            <span class="text-gray-400 text-xs">错题本</span>
        </div>
        <div class="flex flex-col items-center space-y-1">
            <i class="fas fa-chart-line text-blue-600 text-lg"></i>
            <span class="text-blue-600 text-xs font-medium">历史</span>
        </div>
        <div class="flex flex-col items-center space-y-1">
            <i class="fas fa-cog text-gray-400 text-lg"></i>
            <span class="text-gray-400 text-xs">设置</span>
        </div>
    </div>

    <script>
        // 图表数据
        const chartData = {
            all: {
                questions: 80,
                accuracy: '87.5%',
                avgTime: '7.3秒',
                typeDistribution: [35, 20, 15, 5, 3, 2],
                accuracyTrend: {
                    labels: ['2025-05-28', '2025-05-29', '2025-05-29', '2025-05-30'],
                    data: [88, 82, 85, 90]
                },
                timeTrend: {
                    labels: ['2025-05-28', '2025-05-29', '2025-05-29', '2025-05-30'],
                    data: [8.2, 7.8, 7.5, 6.8]
                }
            },
            week: {
                questions: 45,
                accuracy: '89.2%',
                avgTime: '6.8秒',
                typeDistribution: [18, 12, 10, 3, 1, 1],
                accuracyTrend: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    data: [85, 88, 92, 87, 90, 0, 89]
                },
                timeTrend: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    data: [7.2, 6.8, 6.5, 7.1, 6.4, 0, 6.8]
                }
            },
            month: {
                questions: 320,
                accuracy: '85.8%',
                avgTime: '7.8秒',
                typeDistribution: [140, 80, 60, 25, 10, 5],
                accuracyTrend: {
                    labels: ['第1周', '第2周', '第3周', '第4周'],
                    data: [82, 85, 88, 89]
                },
                timeTrend: {
                    labels: ['第1周', '第2周', '第3周', '第4周'],
                    data: [8.5, 8.1, 7.6, 6.8]
                }
            },
            year: {
                questions: 1580,
                accuracy: '84.3%',
                avgTime: '8.1秒',
                typeDistribution: [680, 400, 300, 120, 50, 30],
                accuracyTrend: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                    data: [78, 80, 82, 85, 87, 89]
                },
                timeTrend: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                    data: [9.2, 8.8, 8.5, 8.2, 7.8, 6.8]
                }
            }
        };

        let typeChart, accuracyChart, timeChart;
        let currentFilter = 'all';

        // 初始化图表
        function initCharts() {
            // 题型分布饼状图
            const typeCtx = document.getElementById('typeDistributionChart').getContext('2d');
            typeChart = new Chart(typeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['两位数加减', '三位数加减', '两位数乘一位数', '多位数除两位数', '多位数除三位数', '四位数除法选择题'],
                    datasets: [{
                        data: chartData[currentFilter].typeDistribution,
                        backgroundColor: [
                            '#06b6d4', // cyan-500
                            '#fb923c', // orange-400
                            '#dc2626', // red-600
                            '#9ca3af', // gray-400
                            '#475569', // slate-600
                            '#ef4444'  // red-500
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // 正确率趋势图
            const accuracyCtx = document.getElementById('accuracyTrendChart').getContext('2d');
            accuracyChart = new Chart(accuracyCtx, {
                type: 'line',
                data: {
                    labels: chartData[currentFilter].accuracyTrend.labels,
                    datasets: [{
                        label: '正确率 (%)',
                        data: chartData[currentFilter].accuracyTrend.data,
                        borderColor: '#06b6d4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#06b6d4',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 0,
                            max: 100,
                            grid: {
                                color: '#f3f4f6'
                            },
                            ticks: {
                                color: '#6b7280'
                            }
                        },
                        x: {
                            grid: {
                                color: '#f3f4f6'
                            },
                            ticks: {
                                color: '#6b7280'
                            }
                        }
                    }
                }
            });

            // 用时趋势图
            const timeCtx = document.getElementById('timeTrendChart').getContext('2d');
            timeChart = new Chart(timeCtx, {
                type: 'line',
                data: {
                    labels: chartData[currentFilter].timeTrend.labels,
                    datasets: [{
                        label: '平均用时 (秒)',
                        data: chartData[currentFilter].timeTrend.data,
                        borderColor: '#f59e0b',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#f59e0b',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#f3f4f6'
                            },
                            ticks: {
                                color: '#6b7280',
                                callback: function(value) {
                                    return value + 's';
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: '#f3f4f6'
                            },
                            ticks: {
                                color: '#6b7280'
                            }
                        }
                    }
                }
            });
        }

        // 切换时间筛选
        function switchTimeFilter(filter, element) {
            // 更新按钮状态
            document.querySelectorAll('.time-filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            element.classList.add('active');
            
            currentFilter = filter;
            
            // 更新统计数据
            document.getElementById('total-questions').textContent = chartData[filter].questions;
            document.getElementById('accuracy-rate').textContent = chartData[filter].accuracy;
            document.getElementById('avg-time').textContent = chartData[filter].avgTime;
            
            // 更新图表数据
            updateCharts(filter);
        }

        // 更新图表数据
        function updateCharts(filter) {
            const data = chartData[filter];
            
            // 更新饼状图
            typeChart.data.datasets[0].data = data.typeDistribution;
            typeChart.update();
            
            // 更新正确率趋势图
            accuracyChart.data.labels = data.accuracyTrend.labels;
            accuracyChart.data.datasets[0].data = data.accuracyTrend.data;
            accuracyChart.update();
            
            // 更新用时趋势图
            timeChart.data.labels = data.timeTrend.labels;
            timeChart.data.datasets[0].data = data.timeTrend.data;
            timeChart.update();
        }

        // 页面加载完成后初始化图表
        window.addEventListener('load', function() {
            initCharts();
        });
    </script>
</body>
</html>
